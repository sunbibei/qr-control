<?xml version="1.0" encoding="utf-8"?>
<ctrl name="qr-control-configure" >

  <macro:prototype name="qrLeg" args="leg" >
    <tag auto_inst="qr_control::QrLeg" leg="${leg}" mode="cmd-mode"
      command="${leg}-cmd" tdlo="leg-${leg}-td" 
      pos="leg-${leg}-pos" vel="leg-${leg}-vel" tor="leg-${leg}-tor" />
  </macro:prototype>

  <macro:property name="trial" value="hr" />

  <res>
    <interface>
      <prototype:qrLeg tag="fl" leg="fl" />
      <prototype:qrLeg tag="fr" leg="fr" />
      <prototype:qrLeg tag="hl" leg="hl" />
      <prototype:qrLeg tag="hr" leg="hr" />
    </interface>

    <sensor auto_inst="rl_agent::ChainJointEncoder" name="chain_joint_encoder" joints="${trial}_yaw ${trial}_hip ${trial}_knee">
      <chain root="body" tip="${trial}_foot"
        urdf="/home/bibei/Workspaces/qr_ws/src/qr-next-control/config/qr.urdf" />
    </sensor>
  </res>
  <gait name="gait-repository" activate="walk" >
  <!--gait name="gait-repository" -->
    <creep auto_inst="qr_control::Creep" name="creep" >
      <interface_0 leg="fl" label="ctrl.res.interface.fl" />
      <interface_1 leg="fr" label="ctrl.res.interface.fr" />
      <interface_2 leg="hl" label="ctrl.res.interface.hl" />
      <interface_3 leg="hr" label="ctrl.res.interface.hr" />
      <count description="initilize the __PrivateParam"
        init_pose="300" cali_imu="300" stance="1000" height="300" swing="1000" />
    </creep>
    
    <test auto_inst="qr_control::TestTraj" name="test" >
      <interface_0 leg="fl" label="ctrl.res.interface.fl" />
      <interface_1 leg="fr" label="ctrl.res.interface.fr" />
      <interface_2 leg="hl" label="ctrl.res.interface.hl" />
      <interface_3 leg="hr" label="ctrl.res.interface.hr" />
    </test>

    <agent auto_inst="qr_control::RLAgent" name="agent" gain="1000">
      <interface leg="${trial}" label="ctrl.res.interface.${trial}" />
      <sensor name="chain_joint_encoder" label="ctrl.res.sensor" />
      <topic reset="reset_command_topic"            trial="trial_command_topic"
             report_request="report_requests_topic" report_pub="report_pub_topic" />
    </agent>

    <walk auto_inst="qr_control::Walk" name="walk" 
      tds="qr.res.fl.td qr.res.hl.td qr.res.fr.td qr.res.hr.td"
      imu="qr.res.imu" >
      <interface_0 leg="fl" label="ctrl.res.interface.fl" />
      <interface_1 leg="fr" label="ctrl.res.interface.fr" />
      <interface_2 leg="hl" label="ctrl.res.interface.hl" />
      <interface_3 leg="hr" label="ctrl.res.interface.hr" />

      <sensor name="chain_joint_encoder" label="ctrl.res.sensor" />
      <topic reset="reset_command_topic"            trial="trial_command_topic"
             report_request="report_requests_topic" report_pub="report_pub_topic" />
    </walk>

  </gait>

</ctrl>